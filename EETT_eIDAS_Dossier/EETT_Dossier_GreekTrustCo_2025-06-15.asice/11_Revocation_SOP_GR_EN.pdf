# ΤΥΠΟΠΟΙΗΜΕΝΕΣ ΔΙΑΔΙΚΑΣΙΕΣ ΛΕΙΤΟΥΡΓΙΑΣ (SOP) - ΑΝΑΚΛΗΣΗ ΚΑΙ ΥΠΗΡΕΣΙΕΣ ΚΑΤΑΣΤΑΣΗΣ
## Standard Operating Procedures (SOP) - Revocation and Status Services

**Εταιρεία / Company:** [LEGAL_NAME_GR]  
**Έκδοση / Version:** 1.0  
**Ημερομηνία / Date:** [SUBMISSION_DATE]  
**Ταξινόμηση / Classification:** Εσωτερικό / Εμπιστευτικό

---

## 1. ΣΚΟΠΟΣ

Αυτό το έγγραφο περιγράφει τις τυποποιημένες διαδικασίες λειτουργίας (SOP) για τη διαχείριση των αιτημάτων ανάκλησης και αναστολής πιστοποιητικών, καθώς και τη λειτουργία των υπηρεσιών κατάστασης (OCSP και CRL). Σκοπός είναι η διασφάλιση της συμμόρφωσης με το **Άρθρο 11 του Κανονισμού ΕΕΤΤ** και την παροχή αξιόπιστων και έγκαιρων πληροφοριών στην κοινότητα των αποδεκτών.

---

## 2. 24x7 ΚΑΝΑΛΙΑ ΑΠΟΔΟΧΗΣ ΑΙΤΗΜΑΤΩΝ ΑΝΑΚΛΗΣΗΣ

Ο Πάροχος διασφαλίζει την αδιάλειπτη (24x7x365) αποδοχή αιτημάτων ανάκλησης μέσω των παρακάτω καναλιών.

### 2.1. Τηλεφωνική Γραμμή (Revocation Hotline)
-   **Αριθμός:** **[REVOCATION_HOTLINE]** (χωρίς χρέωση εντός Ελλάδας).
-   **Προσωπικό:** Τουλάχιστον 2 χειριστές ανά βάρδια (NOC/SOC).
-   **Γλώσσες:** Ελληνικά, Αγγλικά.
-   **Διαδικασία Ταυτοποίησης Αιτούντος:**
    1.  Ο χειριστής ζητά το ονοματεπώνυμο του συνδρομητή και τον σειριακό αριθμό του πιστοποιητικού.
    2.  Ο χειριστής θέτει 2-3 ερωτήσεις ασφαλείας που ορίστηκαν κατά την εγγραφή (π.χ., "Ποιο είναι το πατρικό όνομα της μητέρας σας;", "Ποιος είναι ο ταχυδρομικός κώδικας της κατοικίας σας;").
    3.  Εάν οι απαντήσεις είναι σωστές, το αίτημα θεωρείται έγκυρο. Σε περίπτωση αποτυχίας, ο χειριστής ενημερώνει τον καλούντα ότι η ταυτοποίηση απέτυχε και προτείνει εναλλακτικές μεθόδους (π.χ. αυτοπρόσωπη παρουσία).
-   **Καταγραφή:** Κάθε κλήση καταγράφεται (ήχος και μεταγραφή) και αποθηκεύεται με χρονοσήμανση στο σύστημα διαχείρισης περιστατικών.

### 2.2. Διαδικτυακή Πύλη (Web Portal)
-   **URL:** **[WEBSITE_URL]/revoke**
-   **Πρόσβαση:** Απαιτείται σύνδεση του συνδρομητή με όνομα χρήστη, κωδικό πρόσβασης και κωδικό μίας χρήσης (2FA).
-   **Διαδικασία:** Ο συνδρομητής επιλέγει το πιστοποιητικό προς ανάκληση, επιλέγει έναν λόγο και επιβεβαιώνει το αίτημα.
-   **Επιβεβαίωση:** Αποστέλλεται αυτόματα email και SMS επιβεβαίωσης στον συνδρομητή.

### 2.3. Ηλεκτρονικό Ταχυδρομείο (Email)
-   **Διεύθυνση:** **[REVOCATION_EMAIL]**
-   **Απαιτήσεις:** Το αίτημα πρέπει να είναι υπογεγραμμένο ψηφιακά με ένα άλλο έγκυρο πιστοποιητικό του ίδιου συνδρομητή. Αιτήματα χωρίς υπογραφή απορρίπτονται αυτόματα με ενημερωτικό email.

### 2.4. Αυτοπρόσωπη Παρουσία
-   **Τοποθεσία:** Στα εξουσιοδοτημένα γραφεία της Αρχής Εγγραφής (RA) κατά τις εργάσιμες ώρες.
-   **Διαδικασία:** Απαιτείται επίδειξη επίσημου εγγράφου ταυτοποίησης (ταυτότητα, διαβατήριο) και υπογραφή στο έντυπο αίτησης ανάκλησης.

---

## 3. ΔΙΑΔΙΚΑΣΙΕΣ ΕΠΕΞΕΡΓΑΣΙΑΣ ΑΝΑΚΛΗΣΗΣ

### 3.1. Χρόνος Επεξεργασίας (SLA)
-   **Στόχος:** Η κατάσταση ανάκλησης να αντικατοπτρίζεται στην υπηρεσία OCSP εντός **15 λεπτών** από την έγκυρη υποβολή του αιτήματος.
-   **Μέγιστος Χρόνος:** Σε κάθε περίπτωση, η επεξεργασία ολοκληρώνεται εντός **1 ώρας**.

### 3.2. Βήματα Επεξεργασίας
1.  **Άμεση Αποδοχή & Καταγραφή:** Κάθε αίτημα λαμβάνει αμέσως ένα μοναδικό αναγνωριστικό (ticket ID) στο σύστημα διαχείρισης περιστατικών (ITSM).
2.  **Επικύρωση Αιτούντος:** Ο χειριστής (RA Operator ή NOC/SOC analyst) επικυρώνει την ταυτότητα του αιτούντος σύμφωνα με τις διαδικασίες της Ενότητας 2.
3.  **Εκτέλεση Ανάκλησης:**
    -   Ο εξουσιοδοτημένος διαχειριστής (CA Administrator) ενημερώνει την κατάσταση του πιστοποιητικού στη βάση δεδομένων της CA σε "revoked".
    -   Καταχωρείται ο κατάλληλος κωδικός λόγου ανάκλησης (Reason Code) και η ακριβής χρονοσήμανση της ανάκλησης (UTC).
4.  **Ενημέρωση Υπηρεσιών Κατάστασης:** Το σύστημα ενεργοποιεί αυτόματα την εκκαθάριση της προσωρινής μνήμης (cache) των OCSP responders και προγραμματίζει τη συμπερίληψη της ανάκλησης στην επόμενη έκδοση της CRL.
5.  **Ειδοποίηση Συνδρομητή:** Αποστέλλεται αυτόματο email και SMS στον συνδρομητή που επιβεβαιώνει την επιτυχή ανάκληση.

### 3.3. Κωδικοί Λόγων Ανάκλησης (RFC 5280)
-   `0`: unspecified
-   `1`: keyCompromise (διαρροή κλειδιού)
-   `3`: affiliationChanged (αλλαγή σχέσης, π.χ. αποχώρηση υπαλλήλου)
-   `4`: superseded (αντικαταστάθηκε)
-   `5`: cessationOfOperation (παύση χρήσης)
-   `9`: privilegeWithdrawn (ανάκληση προνομίου)

---

## 4. ΔΙΑΔΙΚΑΣΙΕΣ ΑΝΑΣΤΟΛΗΣ (SUSPENSION)

### 4.1. Σενάρια Αναστολής
-   **GR:** Ο Πάροχος επιτρέπει την προσωρινή αναστολή ενός πιστοποιητικού κατόπιν αιτήματος του συνδρομητή, π.χ. σε περίπτωση προσωρινής απώλειας της ΔΕΔΥ (QSCD).
-   **EN:** The Provider allows for the temporary suspension of a certificate upon subscriber request, e.g., in case of temporary loss of the QSCD.

### 4.2. Διαδικασία
-   **Μέγιστη Διάρκεια:** Η αναστολή μπορεί να διαρκέσει το πολύ **30 ημέρες**.
-   **Κατάσταση:** Το πιστοποιητικό επισημαίνεται με τον κωδικό `certificateHold` (6) στη CRL. Για λόγους ασφαλείας, η υπηρεσία OCSP θα επιστρέφει την κατάσταση "revoked".
-   **Επαναφορά:** Εάν ο συνδρομητής ανακτήσει τον έλεγχο της ΔΕΔΥ εντός 30 ημερών, μπορεί να ζητήσει την επαναφορά του πιστοποιητικού σε ενεργή κατάσταση.
-   **Αυτόματη Ανάκληση:** Εάν δεν υπάρξει αίτημα επαναφοράς εντός 30 ημερών, το πιστοποιητικό ανακαλείται αυτόματα και οριστικά με λόγο `keyCompromise`.

---

## 5. ΛΕΙΤΟΥΡΓΙΑ ΥΠΗΡΕΣΙΑΣ OCSP

### 5.1. Αρχιτεκτονική
-   **Responders:** Τουλάχιστον 4 OCSP responders σε διάταξη υψηλής διαθεσιμότητας (N+1, load-balanced) σε δύο γεωγραφικά κατανεμημένα data centers.
-   **Υπογραφή:** Οι απαντήσεις OCSP υπογράφονται με ειδικά, βραχύβια (validity: 1 έτος) πιστοποιητικά OCSP, τα οποία εκδίδονται από την αντίστοιχη Issuing CA. Τα κλειδιά αυτά φυλάσσονται σε HSM.

### 5.2. Μετρικές Απόδοσης (SLA)
-   **Διαθεσιμότητα:** **99.95%** ετησίως.
-   **Χρόνος Απόκρισης:** **< 150ms** για το 95% των αιτημάτων (95th percentile).
-   **Nonce:** Υποστηρίζεται υποχρεωτικά για την αποτροπή επιθέσεων επανάληψης (replay attacks).

### 5.3. Caching
-   Οι απαντήσεις OCSP περιέχουν το πεδίο `nextUpdate`, το οποίο ορίζεται σε **4 ώρες** από την ώρα της απόκρισης.

---

## 6. ΛΕΙΤΟΥΡΓΙΑ ΥΠΗΡΕΣΙΑΣ CRL

### 6.1. Συχνότητα Έκδοσης
-   **Πλήρης CRL (Full CRL):** Εκδίδεται **κάθε 12 ώρες**. Το πεδίο `nextUpdate` ορίζεται στις 13 ώρες για να υπάρχει επικάλυψη.
-   **Delta CRL:** Εκδίδεται **κάθε 1 ώρα**. Το πεδίο `nextUpdate` ορίζεται στα 70 λεπτά.

### 6.2. Διανομή και Υπογραφή
-   **URL:** Οι CRLs είναι διαθέσιμες μέσω HTTP από πολλαπλά σημεία διανομής (CDNs).
-   **Υπογραφή:** Οι CRLs υπογράφονται απευθείας από το ιδιωτικό κλειδί της αντίστοιχης Issuing CA εντός του HSM.

---

## 7. ΔΙΑΔΙΚΑΣΙΕΣ ΑΝΑΚΛΗΣΗΣ ΕΚΤΑΚΤΗΣ ΑΝΑΓΚΗΣ

### 7.1. Διαρροή Κλειδιού Αρχής Πιστοποίησης (CA Key Compromise)
1.  **Άμεσος Περιορισμός:** Άμεση αναστολή λειτουργίας όλων των υπηρεσιών της επηρεαζόμενης CA.
2.  **Ειδοποίηση (εντός 1 ώρας):** Ενημέρωση της ΕΕΤΤ (Περιστατικό Επιπέδου 5), της διοίκησης και έναρξη σχεδίου επικοινωνίας προς το κοινό.
3.  **Ανάκληση Πιστοποιητικού CA:** Η υπερκείμενη CA ανακαλεί το πιστοποιητικό της παραβιασμένης CA.
4.  **Τελική CRL:** Κατά το δυνατόν, δημιουργία μιας τελικής CRL που περιέχει όλα τα πιστοποιητικά που εκδόθηκαν από την παραβιασμένη CA, με λόγο ανάκλησης `caCompromise`.

### 7.2. Μαζική Ανάκληση (Mass Revocation)
-   **Σενάριο:** Εντοπισμός ευπάθειας που επηρεάζει μεγάλο αριθμό πιστοποιητικών.
-   **Διαδικασία:**
    1.  Εντοπισμός της λίστας των επηρεαζόμενων πιστοποιητικών μέσω ανάλυσης της βάσης δεδομένων.
    2.  Εκτέλεση μαζικής ανάκλησης με αυτοματοποιημένο script.
    3.  Άμεση έκδοση νέας CRL και εκκαθάριση του cache των OCSP responders.
    4.  Ενημέρωση όλων των επηρεαζόμενων συνδρομητών μέσω email και SMS.

---

## 8. ΠΑΡΑΚΟΛΟΥΘΗΣΗ, ΜΕΤΡΗΣΕΙΣ ΚΑΙ ΑΝΑΦΟΡΕΣ

### 8.1. Μετρικές Παρακολούθησης (Metrics)
-   Αριθμός αιτημάτων ανάκλησης ανά ημέρα/κανάλι.
-   Μέσος χρόνος επεξεργασίας ανάκλησης (MTTR - Mean Time To Revoke).
-   Uptime (%) των υπηρεσιών OCSP και CRL.
-   Χρόνος απόκρισης OCSP (p50, p95, p99).
-   Μέγεθος και ρυθμός αύξησης των CRLs.

### 8.2. Ειδοποιήσεις (Alerts)
-   Ειδοποίηση SMS στην ομάδα NOC/SOC εάν η υπηρεσία OCSP/CRL δεν είναι διαθέσιμη για > 5 λεπτά.
-   Ειδοποίηση στον QTS Manager εάν η ουρά αιτημάτων ανάκλησης υπερβεί τα 10.
-   Ειδοποίηση στην ομάδα ασφαλείας για αφύσικη αύξηση στα αιτήματα ανάκλησης (>5x του μέσου όρου).

### 8.3. Αναφορές (Reporting)
-   Μηνιαία αναφορά απόδοσης (SLA report) των υπηρεσιών ανάκλησης και κατάστασης υποβάλλεται στον QTS Manager.
-   Τριμηνιαία σύνοψη των μετρικών και των περιστατικών παρουσιάζεται στη διοίκηση.

---
**Τέλος Εγγράφου**