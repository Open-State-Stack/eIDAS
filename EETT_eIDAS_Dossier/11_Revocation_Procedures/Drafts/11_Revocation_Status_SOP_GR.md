# ΤΥΠΟΠΟΙΗΜΕΝΕΣ ΔΙΑΔΙΚΑΣΙΕΣ ΛΕΙΤΟΥΡΓΙΑΣ (SOP) - ΑΝΑΚΛΗΣΗ ΚΑΙ ΥΠΗΡΕΣΙΕΣ ΚΑΤΑΣΤΑΣΗΣ
## Standard Operating Procedures (SOP) - Revocation and Status Services

---

## COMPLIANCE CHECKLIST

| Κανονισμός / Regulation | Απαίτηση / Requirement | Ενότητα / Section | Σελίδα / Page |
|--------------------------|------------------------|-------------------|---------------|
| **eIDAS Regulation (EU) 910/2014** |
| Article 24(2)(d) | Revocation services available 24/7 | §2, §3 | 3-6 |
| Article 24(2)(h) | Immediate revocation upon request | §3.1 | 6 |
| Article 24(4)(d) | Status information services (OCSP/CRL) | §5, §6 | 10-13 |
| **EETT Κανονισμός - Άρθρο 11** |
| Article 11.1 | 24×7 revocation acceptance channels | §2 | 3-5 |
| Article 11.2 | Telephone authentication procedures | §2.1, §3.2 | 3-4, 7-8 |
| Article 11.3 | Revocation processing timeframes (≤24h) | §3.1 | 6 |
| Article 11.4 | OCSP/CRL service requirements | §5, §6 | 10-13 |
| Article 11.5 | Emergency revocation procedures | §7 | 14-15 |
| **ETSI EN 319 401** (Recommended) |
| §6.4.3 | Revocation request authentication | §2, §3.2 | 3-5, 7-8 |
| §6.4.4 | Revocation processing procedures | §3 | 6-9 |
| **RFC 5280** |
| §3.3, §5 | CRL format and processing | §6 | 12-13 |
| §2.2 | OCSP responder requirements | §5 | 10-12 |

**Έκδοση / Version:** 2.0 (Enriched for Submission)  
**Ημερομηνία / Date:** [SUBMISSION_DATE]  
**Κατάσταση / Status:** Final - Ready for EETT Submission  
**Εταιρεία / Company:** [LEGAL_NAME_GR] ([LEGAL_NAME_EN])  
**Ταξινόμηση / Classification:** Εσωτερικό / Εμπιστευτικό  
**Έγκριση / Approved by:** [QTS_MANAGER_NAME], Qualified Trust Services Manager

---

## ΠΙΝΑΚΑΣ ΠΕΡΙΕΧΟΜΕΝΩΝ / TABLE OF CONTENTS

1. [ΣΚΟΠΟΣ ΚΑΙ ΠΕΔΙΟ ΕΦΑΡΜΟΓΗΣ](#1-σκοποσ-και-πεδιο-εφαρμογησ)
2. [24×7 ΚΑΝΑΛΙΑ ΑΠΟΔΟΧΗΣ ΑΙΤΗΜΑΤΩΝ ΑΝΑΚΛΗΣΗΣ](#2-247-καναλια-αποδοχησ-αιτηματων-ανακλησησ)
3. [ΔΙΑΔΙΚΑΣΙΕΣ ΕΠΕΞΕΡΓΑΣΙΑΣ ΑΝΑΚΛΗΣΗΣ](#3-διαδικασιεσ-επεξεργασιασ-ανακλησησ)
4. [ΔΙΑΔΙΚΑΣΙΕΣ ΑΝΑΣΤΟΛΗΣ (SUSPENSION)](#4-διαδικασιεσ-αναστολησ-suspension)
5. [ΛΕΙΤΟΥΡΓΙΑ ΥΠΗΡΕΣΙΑΣ OCSP](#5-λειτουργια-υπηρεσιασ-ocsp)
6. [ΛΕΙΤΟΥΡΓΙΑ ΥΠΗΡΕΣΙΑΣ CRL](#6-λειτουργια-υπηρεσιασ-crl)
7. [ΔΙΑΔΙΚΑΣΙΕΣ ΑΝΑΚΛΗΣΗΣ ΕΚΤΑΚΤΗΣ ΑΝΑΓΚΗΣ](#7-διαδικασιεσ-ανακλησησ-εκτακτησ-αναγκησ)
8. [ΠΑΡΑΚΟΛΟΥΘΗΣΗ, ΜΕΤΡΗΣΕΙΣ ΚΑΙ ΑΝΑΦΟΡΕΣ](#8-παρακολουθηση-μετρησεισ-και-αναφορεσ)
9. [ΡΟΛΟΙ ΚΑΙ ΕΥΘΥΝΕΣ](#9-ρολοι-και-ευθυνεσ)
10. [ΔΙΑΧΕΙΡΙΣΗ ΑΛΛΑΓΩΝ](#10-διαχειριση-αλλαγων)

---

## 1. ΣΚΟΠΟΣ ΚΑΙ ΠΕΔΙΟ ΕΦΑΡΜΟΓΗΣ

### 1.1. Σκοπός

Αυτό το έγγραφο καθορίζει τις τυποποιημένες διαδικασίες λειτουργίας (Standard Operating Procedures - SOP) για:
- Τη διαχείριση αιτημάτων ανάκλησης και αναστολής πιστοποιητικών
- Τη λειτουργία των υπηρεσιών κατάστασης πιστοποιητικών (OCSP και CRL)
- Τις διαδικασίες έκτακτης ανάγκης για μαζική ανάκληση και διαρροή κλειδιού CA

**Κανονιστικό Πλαίσιο:**
- **Κανονισμός eIDAS (EU) 910/2014**, Άρθρο 24, παράγραφοι (2)(d), (2)(h), και (4)(d)
- **ΕΕΤΤ Κανονισμός**, Άρθρο 11 (Υπηρεσίες Ανάκλησης και Κατάστασης)
- **ETSI EN 319 401** (General Policy Requirements for Trust Service Providers) - Συνιστώμενο
- **RFC 5280** (Internet X.509 Public Key Infrastructure Certificate and CRL Profile)

### 1.2. Πεδίο Εφαρμογής

Αυτό το SOP εφαρμόζεται σε όλες τις υπηρεσίες εμπιστοσύνης που παρέχει ο [LEGAL_NAME_GR]:
- ✅ Qualified Electronic Signatures (QES) - Ιδιώτες
- ✅ Qualified Electronic Signatures (QES) - Νομικά Πρόσωπα
- ✅ Qualified Electronic Seals (QSeal)
- ✅ Qualified Web Authentication Certificates (QWAC)
- ✅ Qualified Timestamp Services (QTS)
- ✅ [Άλλες υπηρεσίες: προσθήκη κατά περίπτωση]

### 1.3. Ορισμοί

- **Ανάκληση (Revocation):** Η οριστική και μη αναστρέψιμη ακύρωση ενός πιστοποιητικού πριν τη λήξη της ισχύος του.
- **Αναστολή (Suspension):** Η προσωρινή ακύρωση ενός πιστοποιητικού με δυνατότητα επαναφοράς.
- **Συνδρομητής (Subscriber):** Το φυσικό ή νομικό πρόσωπο στο οποίο έχει εκδοθεί το πιστοποιητικό.
- **Αποδέκτης (Relying Party):** Το άτομο ή οργανισμός που βασίζεται σε ένα πιστοποιητικό για την επαλήθευση υπογραφής/σφραγίδας.
- **OCSP (Online Certificate Status Protocol):** Πρωτόκολλο για άμεση επαλήθευση της κατάστασης ενός πιστοποιητικού.
- **CRL (Certificate Revocation List):** Λίστα ανακληθέντων πιστοποιητικών που δημοσιεύεται περιοδικά.

---

## 2. 24×7 ΚΑΝΑΛΙΑ ΑΠΟΔΟΧΗΣ ΑΙΤΗΜΑΤΩΝ ΑΝΑΚΛΗΣΗΣ

**[🔍 CAB Review Required]**

Ο Πάροχος διασφαλίζει την **αδιάλειπτη (24×7×365)** αποδοχή αιτημάτων ανάκλησης μέσω των παρακάτω καναλιών, σύμφωνα με το **Άρθρο 11.1 του ΕΕΤΤ Κανονισμού** και το **Άρθρο 24(2)(d) του eIDAS**.

### 2.1. Τηλεφωνική Γραμμή (Revocation Hotline)

**[🔍 CAB Review Required: Authentication Protocol]**

#### 2.1.1. Στοιχεία Επικοινωνίας

- **Αριθμός:** **[REVOCATION_HOTLINE]** (χωρίς χρέωση εντός Ελλάδας, διεθνείς κλήσεις αποδεκτές)
- **Προσωπικό:** Τουλάχιστον **2 χειριστές ανά βάρδια** (NOC/SOC), με εφεδρεία (N+1 redundancy)
- **Βάρδιες:** 3 βάρδιες × 8 ώρες (07:00-15:00, 15:00-23:00, 23:00-07:00 EET/EEST)
- **Γλώσσες:** Ελληνικά (υποχρεωτικά), Αγγλικά (υποχρεωτικά)
- **Εκπαίδευση Χειριστών:** Όλοι οι χειριστές εκπαιδεύονται ετησίως σε:
  - Διαδικασίες ταυτοποίησης και αποτροπή κοινωνικής μηχανικής
  - Χειρισμό περιστατικών υψηλής πίεσης
  - Κανονιστικές απαιτήσεις (GDPR, eIDAS)

#### 2.1.2. Διαδικασία Ταυτοποίησης Αιτούντος

**🔐 ΚΡΙΣΙΜΟ: Η τηλεφωνική ταυτοποίηση πρέπει να αποτρέπει την απάτη και την κοινωνική μηχανική.**

Ο χειριστής ακολουθεί την παρακάτω **βηματική διαδικασία**:

##### **ΒΗΜΑ 1: Χαιρετισμός και Εξήγηση Διαδικασίας**

```
Χειριστής: "Καλημέρα/Καλησπέρα, [LEGAL_NAME_GR] Γραμμή Ανάκλησης, μιλάει ο/η [OPERATOR_NAME]. 
Για να προχωρήσω στην ανάκληση του πιστοποιητικού σας, χρειάζεται να επιβεβαιώσω την ταυτότητά σας. 
Παρακαλώ έχετε έτοιμο το email εγγραφής σας και τον σειριακό αριθμό του πιστοποιητικού, εάν είναι δυνατόν."
```

##### **ΒΗΜΑ 2: Συλλογή Αρχικών Στοιχείων**

Ο χειριστής ζητά:
1. **Ονοματεπώνυμο** συνδρομητή (ακριβώς όπως εμφανίζεται στο πιστοποιητικό)
2. **Διεύθυνση email** εγγραφής
3. **Σειριακός αριθμός πιστοποιητικού** (προαιρετικός - εάν ο συνδρομητής δεν τον έχει, αναζήτηση στη βάση δεδομένων με τα παραπάνω στοιχεία)

Ο χειριστής ανακτά το **εγγραφικό αρχείο (enrollment record)** του συνδρομητή από το σύστημα.

##### **ΒΗΜΑ 3: Επιλογή Μεθόδου Ταυτοποίησης**

Ο χειριστής επιλέγει τη μέθοδο ανάλογα με τον **τύπο πιστοποιητικού** και την **κατάσταση του συνδρομητή**:

---

#### **📋 ΜΕΘΟΔΟΣ A: ΤΥΠΙΚΗ ΤΑΥΤΟΠΟΙΗΣΗ (Standard Authentication)**

**Χρήση:** Για τα περισσότερα πιστοποιητικά (QES ιδιωτών, QSeal μικρών επιχειρήσεων, QWAC)

**Διαδικασία:**

1. **Ερώτηση Ασφαλείας:**
   Ο χειριστής θέτει **2 από τις 3** προκαθορισμένες ερωτήσεις ασφαλείας που έχει ορίσει ο συνδρομητής κατά την εγγραφή:
   
   - "Ποιο είναι το **πατρικό όνομα της μητέρας** σας;"
   - "Ποιος είναι ο **ταχυδρομικός κώδικας της κατοικίας** σας που δηλώσατε κατά την εγγραφή;"
   - "Ποια είναι η **αγαπημένη σας πόλη** που δηλώσατε κατά την εγγραφή;" (προσαρμοσμένη ερώτηση)

2. **Επαλήθευση Απαντήσεων:**
   - ✅ **Εάν 2/2 σωστές:** Συνέχεια στη Διαδικασία Ανάκλησης (βλ. §3.2)
   - ❌ **Εάν 1/2 ή 0/2 σωστές:** Αποτυχία ταυτοποίησης → Μετάβαση σε **Μέθοδο B** ή **Μέθοδο C**

---

#### **📋 ΜΕΘΟΔΟΣ B: ΕΝΙΣΧΥΜΕΝΗ ΤΑΥΤΟΠΟΙΗΣΗ (High-Value Certificates)**

**Χρήση:** 
- Πιστοποιητικά νομικών προσώπων με υψηλό όριο ευθύνης (> €50,000)
- QSeal μεγάλων οργανισμών
- Πιστοποιητικά με πρόσβαση σε ευαίσθητα συστήματα

**Διαδικασία:**

1. **Μέθοδος A (ως άνω)** ΣΥΝ
2. **Callback Verification (Επιστροφή Κλήσης):**
   - Ο χειριστής λέει: *"Για την ασφάλειά σας, θα σας καλέσω πίσω στον αριθμό που έχετε δηλώσει κατά την εγγραφή: [PHONE_ON_FILE]. Παρακαλώ αναμείνετε την κλήση μου σε 2 λεπτά."*
   - Ο χειριστής κλείνει την τρέχουσα κλήση.
   - Ο χειριστής καλεί τον **εγγεγραμμένο αριθμό τηλεφώνου** από το σύστημα (όχι τον αριθμό που εμφανίζεται στο caller ID της εισερχόμενης κλήσης).
   - Όταν ο συνδρομητής απαντήσει, ο χειριστής επιβεβαιώνει: *"Είστε ο/η [SUBSCRIBER_NAME]; Καλέσατε πριν 2 λεπτά για ανάκληση πιστοποιητικού;"*
   - ✅ **Εάν επιβεβαιωθεί:** Συνέχεια στη Διαδικασία Ανάκλησης
   - ❌ **Εάν δεν επιβεβαιωθεί:** Πιθανή απάτη → Μετάβαση σε **Μέθοδο C** (RA Manager escalation)

**Σκεπτικό:** Η επιστροφή κλήσης αποτρέπει την κλώνηση SIM και την παράνομη χρήση caller ID spoofing.

---

#### **📋 ΜΕΘΟΔΟΣ C: ΕΝΑΛΛΑΚΤΙΚΗ ΤΑΥΤΟΠΟΙΗΣΗ (Fallback - Lost Device)**

**Χρήση:**
- Ο συνδρομητής δεν μπορεί να απαντήσει τις ερωτήσεις ασφαλείας (π.χ. τις έχει ξεχάσει)
- Το τηλέφωνο εγγραφής δεν είναι πλέον διαθέσιμο
- Ύποπτη κατάσταση που απαιτεί επιπλέον επαλήθευση

**Διαδικασία:**

1. **Κωδικός Μίας Χρήσης (OTP) μέσω Email:**
   - Ο χειριστής λέει: *"Για την ασφάλειά σας, θα σας στείλω έναν κωδικό μίας χρήσης στο email εγγραφής σας: [EMAIL_ON_FILE]. Παρακαλώ παραμείνετε στη γραμμή και δώστε μου τον 6ψήφιο κωδικό που θα λάβετε."*
   - Το σύστημα στέλνει αυτόματα OTP (ισχύς: 10 λεπτά)
   - Ο συνδρομητής διαβάζει τον κωδικό
   - ✅ **Εάν σωστός:** Συνέχεια στη Διαδικασία Ανάκλησης
   - ❌ **Εάν λάθος ή δεν ελήφθη email:** Μετάβαση στην επόμενη επιλογή

2. **Αναβάθμιση σε RA Manager (Escalation):**
   - Ο χειριστής λέει: *"Δυστυχώς δεν μπορώ να επιβεβαιώσω την ταυότητά σας μέσω αυτών των μεθόδων. Θα πρέπει να επικοινωνήσετε με τον Διαχειριστή Εγγραφής για πρόσθετη επαλήθευση. Θα σας καλέσει σήμερα στις [TIME]."*
   - Ο χειριστής δημιουργεί **escalation ticket** για τον RA Manager
   - Ο RA Manager επικοινωνεί με τον συνδρομητή και απαιτεί:
     - **Video call** με επίδειξη επίσημου εγγράφου ταυτοποίησης (ταυτότητα, διαβατήριο), ή
     - **Αυτοπρόσωπη παρουσία** στα γραφεία RA (βλ. §2.4)

---

#### 2.1.3. 🚨 Ανίχνευση Απάτης - Red Flags (Fraud Detection)

**Οι χειριστές έχουν εκπαιδευτεί να εντοπίζουν τις ακόλουθες ύποπτες συμπεριφορές:**

| 🔴 Red Flag | Ενδεικτικά Σημάδια | Δράση Χειριστή |
|------------|-------------------|----------------|
| **Διστακτικότητα / Μαντεύει** | Ο καλών διστάζει πριν απαντήσει στις ερωτήσεις ασφαλείας, ή προσπαθεί πολλές εναλλακτικές απαντήσεις | ⚠️ Σημειώνεται στο σύστημα, απαιτείται Μέθοδος B ή C |
| **Θόρυβος Call Center** | Θόρυβος πολλών ατόμων, τυπικός ήχος call center στο φόνο | 🚨 **Πιθανή μαζική επίθεση** → Άμεση αναβάθμιση σε RA Manager και Security Team |
| **Πίεση για Επείγον** | "Είναι επείγον, απλά ανακαλέστε το!", "Δεν έχω χρόνο για ερωτήσεις" | ⚠️ Τυπική τακτική κοινωνικής μηχανικής → **Δεν επιταχύνεται** η διαδικασία, συνέχεια στο πρωτόκολλο |
| **Φωνή δεν ταιριάζει** | Αρσενική φωνή για γυναικείο όνομα (ή αντίστροφα), ξένη προφορά για Έλληνα πολίτη (εάν δεν αντιστοιχεί στα εγγραφικά στοιχεία) | ⚠️ Απαιτείται επιπλέον επαλήθευση (Μέθοδος B) |
| **Άγνοια Βασικών Στοιχείων** | Δεν γνωρίζει το email εγγραφής, την ημερομηνία έκδοσης, ή βασικά στοιχεία πιστοποιητικού | ⚠️ Πιθανός μη νόμιμος κάτοχος → Απαιτείται Μέθοδος C |
| **Πολλαπλές Απόπειρες** | Ο ίδιος αριθμός καλεί για ανάκληση διαφορετικών πιστοποιητικών εντός σύντομου χρονικού διαστήματος (< 1 ώρα) | 🚨 **Πιθανή μαζική επίθεση** → Block αριθμού, αναβάθμιση σε Security Team |

**Δράση σε περίπτωση υποψίας απάτης:**

1. Ο χειριστής λέει με ήρεμο, επαγγελματικό τόνο:
   > "Για την ασφάλειά σας, χρειάζομαι να επιβεβαιώσω αυτό το αίτημα με τον επιβλέποντα μου. Παρακαλώ παραμείνετε στη γραμμή."

2. Ο χειριστής θέτει την κλήση σε αναμονή (hold) και ενημερώνει τον **RA Manager** ή **NOC Supervisor**.

3. Προσπάθεια **callback** στον εγγεγραμμένο αριθμό του πραγματικού συνδρομητή για επιβεβαίωση εάν έχει ζητήσει ανάκληση.

4. Εάν επιβεβαιωθεί απάτη:
   - ❌ **Απόρριψη** του αιτήματος
   - 📝 **Καταγραφή περιστατικού** ασφαλείας (Security Incident Report)
   - 📞 **Ειδοποίηση** του πραγματικού συνδρομητή (email + SMS): *"Εντοπίστηκε μη εξουσιοδοτημένη προσπάθεια ανάκλησης του πιστοποιητικού σας. Το αίτημα απορρίφθηκε. Εάν δεν το αναγνωρίζετε, παρακαλούμε επικοινωνήστε μαζί μας αμέσως."*
   - 🚨 **Escalation** στο Security Operations Center (SOC) για περαιτέρω διερεύνηση

#### 2.1.4. Καταγραφή Κλήσεων

- **Όλες** οι κλήσεις στη γραμμή ανάκλησης **καταγράφονται** (ήχος υψηλής ποιότητας, 128 kbps)
- Αυτόματη ηχητική κοινοποίηση στον καλούντα: *"Αυτή η κλήση καταγράφεται για λόγους ποιότητας και ασφαλείας."*
- Οι ηχογραφήσεις αποθηκεύονται με **κρυπτογράφηση AES-256** για **7 έτη** (eIDAS/EETT recordkeeping requirement)
- Πρόσβαση στις ηχογραφήσεις: Μόνο RA Manager, Compliance Officer, και CAB auditors
- Αυτόματη **μεταγραφή (transcription)** μέσω AI για αναζήτηση και ανάλυση (με GDPR safeguards)

---

### 2.2. Διαδικτυακή Πύλη (Web Portal)

#### 2.2.1. Στοιχεία Πρόσβασης

- **URL:** **[WEBSITE_URL]/revoke** (HTTPS υποχρεωτικά, TLS 1.3)
- **Διαθεσιμότητα:** 24×7 (SLA 99.9%)
- **Πρόσβαση:** Απαιτείται **σύνδεση (login)** του συνδρομητή με:
  - Όνομα χρήστη (email εγγραφής)
  - Κωδικός πρόσβασης (min. 12 χαρακτήρες, κριτήρια ισχυρότητας NIST SP 800-63B)
  - **2FA (Two-Factor Authentication)** υποχρεωτικά:
    - SMS OTP (προτιμώμενο)
    - TOTP app (Google Authenticator, Authy)
    - Email OTP (εφεδρικό)

#### 2.2.2. Διαδικασία Ανάκλησης

1. Ο συνδρομητής συνδέεται στην πύλη
2. Επιλέγει **"Τα Πιστοποιητικά Μου"** → Εμφανίζονται όλα τα ενεργά πιστοποιητικά του
3. Κλικ στο πιστοποιητικό → **"Ανάκληση"**
4. Επιλογή **λόγου ανάκλησης** από dropdown:
   - 🔑 Διαρροή κλειδιού / χάθη

---

# PART 2: CONTINUATION OF REVOCATION SOP

## 2.2. Διαδικτυακή Πύλη (Web Portal) - Συνέχεια

#### 2.2.2. Διαδικασία Ανάκλησης (συνέχεια)

4. Επιλογή **λόγου ανάκλησης** από dropdown:
   - 🔑 **Διαρροή κλειδιού / Χάθηκε η συσκευή** (keyCompromise - RFC 5280 reason code 1)
   - 🏢 **Αλλαγή εργασίας / Αποχώρηση** (affiliationChanged - reason code 3)
   - 🔄 **Αντικατάσταση πιστοποιητικού** (superseded - reason code 4)
   - ⏹️ **Παύση χρήσης** (cessationOfOperation - reason code 5)
   - 📋 **Άλλο** (unspecified - reason code 0)

5. **Επιβεβαίωση αιτήματος:**
   - Εμφανίζεται παράθυρο επιβεβαίωσης:
     > "⚠️ ΠΡΟΕΙΔΟΠΟΙΗΣΗ: Η ανάκληση είναι ΜΟΝΙΜΗ και ΔΕΝ μπορεί να αναιρεθεί. Μετά την ανάκληση, δεν θα μπορείτε να χρησιμοποιήσετε αυτό το πιστοποιητικό ξανά. Είστε σίγουροι;"
   - Ο συνδρομητής πληκτρολογεί **"ΕΠΙΒΕΒΑΙΩΝΩ"** (CAPTCHA για αποφυγή automation attacks)
   - Κλικ στο κουμπί **"Οριστική Ανάκληση"**

6. **Άμεση επεξεργασία:**
   - Το σύστημα καταχωρεί την ανάκληση αμέσως στη βάση δεδομένων
   - Ticket ID δημιουργείται αυτόματα
   - Timestamp (UTC) καταγράφεται με ακρίβεια millisecond

7. **Επιβεβαίωση:**
   - Εμφανίζεται μήνυμα επιτυχίας στην οθόνη με το Ticket ID
   - Αποστέλλεται αυτόματα:
     - 📧 **Email** επιβεβαίωσης στη διεύθυνση εγγραφής
     - 📱 **SMS** στον εγγεγραμμένο αριθμό κινητού
   - Περιεχόμενο: *"Το πιστοποιητικό σας [SERIAL] ανακλήθηκε επιτυχώς στις [TIMESTAMP] UTC. Ticket ID: [ID]. Η ανάκληση θα εμφανιστεί στο OCSP εντός 15 λεπτών."*

#### 2.2.3. Ασφάλεια Web Portal

- **Rate Limiting:** Μέγιστο 5 αιτήματα ανάκλησης ανά λογαριασμό ανά ώρα (αποτροπή brute force / mass revocation attacks)
- **Session Management:** Αυτόματη αποσύνδεση μετά από 15 λεπτά αδράνειας
- **Audit Logging:** Κάθε ενέργεια καταγράφεται (IP address, user agent, timestamp, action)
- **WAF Protection:** Web Application Firewall με κανόνες OWASP Top 10
- **TLS Pinning:** Προστασία από MitM attacks

---

### 2.3. Ηλεκτρονικό Ταχυδρομείο (Email)

#### 2.3.1. Στοιχεία Επικοινωνίας

- **Διεύθυνση:** **[REVOCATION_EMAIL]**
- **Αποδοχή:** 24×7 (αυτόματη επεξεργασία εισερχόμενων email)
- **Χρόνος απόκρισης:** Αυτόματη απάντηση εντός 1 λεπτού

#### 2.3.2. Απαιτήσεις Αίτησης

**🔐 ΑΠΑΙΤΕΙΤΑΙ ΨΗΦΙΑΚΗ ΥΠΟΓΡΑΦΗ:**

Το αίτημα ανάκλησης μέσω email **πρέπει** να είναι ψηφιακά υπογεγραμμένο με:
- Ένα **άλλο έγκυρο πιστοποιητικό** του ίδιου συνδρομητή (όχι το πιστοποιητικό προς ανάκληση), ή
- Το **ίδιο πιστοποιητικό** (αποδεκτό μόνο αν ο λόγος είναι superseded ή cessationOfOperation, **όχι** keyCompromise)

**Μορφή Αίτησης (Template):**

```
Προς: [REVOCATION_EMAIL]
Θέμα: Αίτηση Ανάκλησης Πιστοποιητικού

Ονοματεπώνυμο: [Όνομα συνδρομητή]
Email Εγγραφής: [Email]
Σειριακός Αριθμός Πιστοποιητικού: 0x[HEX_SERIAL]
Λόγος Ανάκλησης: [keyCompromise / affiliationChanged / superseded / cessationOfOperation / unspecified]

Αιτιολογία: [Περιγραφή λόγου]

Επισυνάπτω την ταυτότητά μου και επιβεβαιώνω ότι ζητώ την άμεση ανάκληση του παραπάνω πιστοποιητικού.

Υπογραφή: [Ψηφιακή υπογραφή S/MIME ή PAdES]
Ημερομηνία: [ISO 8601 format]
```

#### 2.3.3. Αυτόματη Επεξεργασία

1. **Έλεγχος Υπογραφής:**
   - Το σύστημα επαληθεύει αυτόματα την ψηφιακή υπογραφή
   - ✅ **Έγκυρη υπογραφή:** Συνέχεια στο βήμα 2
   - ❌ **Άκυρη ή μη υπάρχουσα υπογραφή:** Αυτόματη απόρριψη + αποστολή email:
     > "Το αίτημά σας για ανάκληση δεν μπορεί να γίνει αποδεκτό επειδή δεν είναι ψηφιακά υπογεγραμμένο. Για λόγους ασφαλείας, απαιτείται ψηφιακή υπογραφή με έγκυρο πιστοποιητικό. Παρακαλούμε χρησιμοποιήστε την τηλεφωνική γραμμή [REVOCATION_HOTLINE] ή την διαδικτυακή πύλη για άμεση ανάκληση."

2. **Επαλήθευση Συνδρομητή:**
   - Το σύστημα ελέγχει αν το email του υπογράφοντα ταιριάζει με το email εγγραφής του πιστοποιητικού προς ανάκληση
   - Έλεγχος αν το Subject DN του υπογράφοντος πιστοποιητικού ταιριάζει με το DN του πιστοποιητικού προς ανάκληση

3. **Δημιουργία Ticket:**
   - Αυτόματη δημιουργία revocation ticket
   - Αποστολή επιβεβαίωσης: *"Λάβαμε το αίτημά σας. Ticket ID: [ID]. Η ανάκληση θα ολοκληρωθεί εντός 1 ώρας."*

4. **Manual Review (Προαιρετικό):**
   - Εάν το σύστημα εντοπίσει ανωμαλίες (π.χ. διαφορετικό όνομα στο Subject), το ticket κλιμακώνεται σε RA Operator για χειροκίνητη επαλήθευση

#### 2.3.4. Περιορισμοί

- **Χρόνος επεξεργασίας:** Μέγιστο **1 ώρα** (συνήθως 15-30 λεπτά)
- **Μέγεθος email:** Μέγιστο 10 MB (για επισυναπτόμενα)
- **Rate limiting:** Μέγιστο 3 αιτήματα ανά email address ανά ώρα

---

### 2.4. Αυτοπρόσωπη Παρουσία (In-Person Revocation)

#### 2.4.1. Τοποθεσίες

Ο συνδρομητής μπορεί να επισκεφθεί τα **εξουσιοδοτημένα γραφεία της Αρχής Εγγραφής (RA)**:

- **Κεντρικά Γραφεία Αθήνας:** [ADDRESS_ATHENS]
  - Ώρες λειτουργίας: Δευτέρα-Παρασκευή, 09:00-17:00 EET/EEST
  - Επικοινωνία: [PHONE_ATHENS]

- **Παράρτημα Θεσσαλονίκης:** [ADDRESS_THESSALONIKI]
  - Ώρες λειτουργίας: Δευτέρα-Παρασκευή, 09:00-17:00 EET/EEST
  - Επικοινωνία: [PHONE_THESSALONIKI]

- **[Άλλες τοποθεσίες, αν υπάρχουν]**

#### 2.4.2. Διαδικασία

1. **Επίδειξη Ταυτότητας:**
   - Ο συνδρομητής επιδεικνύει **επίσημο έγγραφο ταυτοποίησης**:
     - Ελληνική Αστυνομική Ταυτότητα (εν ισχύ)
     - Διαβατήριο (εν ισχύ)
     - Άδεια οδήγησης (εν ισχύ)
     - Για νομικά πρόσωπα: Εξουσιοδότηση + ταυτότητα εξουσιοδοτημένου εκπροσώπου

2. **Συμπλήρωση Εντύπου:**
   - Ο RA Operator παρέχει το έντυπο **"Αίτηση Ανάκλησης Πιστοποιητικού"** (Form 11-REV)
   - Ο συνδρομητής συμπληρώνει:
     - Ονοματεπώνυμο
     - Σειριακός αριθμός πιστοποιητικού (ή αναζήτηση με email)
     - Λόγος ανάκλησης
     - Υπογραφή (χειρόγραφη)

3. **Επαλήθευση από RA Operator:**
   - Ο RA Operator συγκρίνει τη φωτογραφία στο έγγραφο ταυτοποίησης με το άτομο
   - Επαληθεύει ότι το όνομα στην ταυτότητα ταιριάζει με το όνομα στο πιστοποιητικό
   - Φωτοαντίγραφο (ή scan) του εγγράφου ταυτοποίησης επισυνάπτεται στο ticket

4. **Άμεση Εκτέλεση:**
   - Ο RA Operator εισάγει την ανάκληση στο σύστημα **αμέσως** (παρουσία του συνδρομητή)
   - Ο συνδρομητής λαμβάνει **έντυπη απόδειξη** με το Ticket ID και την ώρα ανάκλησης

5. **Αρχειοθέτηση:**
   - Το έντυπο και το αντίγραφο ταυτότητας αρχειοθετούνται φυσικά και ηλεκτρονικά (scan) για 7 έτη

#### 2.4.3. Πλεονεκτήματα

- **Υψηλότερη ασφάλεια:** Καμία πιθανότητα κοινωνικής μηχανικής (φυσική επαλήθευση προσώπου)
- **Άμεση επιβεβαίωση:** Ο συνδρομητής βλέπει την ανάκληση να εκτελείται
- **Νομική ισχύς:** Η χειρόγραφη υπογραφή και το φυσικό έγγραφο παρέχουν ισχυρή απόδειξη

---

## 3. ΔΙΑΔΙΚΑΣΙΕΣ ΕΠΕΞΕΡΓΑΣΙΑΣ ΑΝΑΚΛΗΣΗΣ

### 3.1. Χρόνος Επεξεργασίας (SLA)

**Κανονιστική Απαίτηση:** Άρθρο 11.3 ΕΕΤΤ Κανονισμού, Άρθρο 24(2)(h) eIDAS

| Μέθοδος Αποδοχής | Στόχος (Target) | Μέγιστος Χρόνος (Maximum) | Κανονιστικό Όριο |
|------------------|-----------------|---------------------------|------------------|
| **Τηλεφωνική Γραμμή** | 5 λεπτά | 15 λεπτά | 24 ώρες (eIDAS) |
| **Web Portal** | Άμεσα (< 1 λεπτό) | 5 λεπτά | 24 ώρες (eIDAS) |
| **Email** | 15 λεπτά | 1 ώρα | 24 ώρες (eIDAS) |
| **Αυτοπρόσωπη** | Άμεσα (παρουσία συνδρομητή) | 5 λεπτά | 24 ώρες (eIDAS) |

**Ορισμός "Επεξεργασία":**
- **Έναρξη:** Χρόνος που το έγκυρο αίτημα γίνεται αποδεκτό από το σύστημα
- **Ολοκλήρωση:** Χρόνος που η κατάσταση "revoked" αντικατοπτρίζεται στο OCSP responder

**Μέτρηση:**
- Αυτόματη μέτρηση για κάθε revocation ticket: `Time_OCSP_Updated - Time_Request_Received`
- Μηνιαία αναφορά SLA compliance: % των αιτημάτων που πληρούν τον στόχο

### 3.2. Βήματα Επεξεργασίας (Detailed Process Flow)

#### **ΒΗΜΑ 1: Άμεση Αποδοχή & Καταγραφή**

**Τι συμβαίνει:**
- Κάθε αίτημα (από οποιοδήποτε κανάλι) λαμβάνει **αμέσως** ένα μοναδικό αναγνωριστικό:
  - **Format:** `REV-YYYYMMDD-NNNN` (π.χ. REV-20250115-0042)
- Το ticket καταχωρείται στο **ITSM (IT Service Management) σύστημα** με:
  - Timestamp (UTC, precision: millisecond)
  - Κανάλι αποδοχής (Phone / Web / Email / In-person)
  - Στοιχεία αιτούντος (pseudonymized για GDPR compliance)
  - Serial number πιστοποιητικού
  - Λόγος ανάκλησης (reason code)
  - Κατάσταση: **"PENDING_AUTHENTICATION"**

**Υπεύθυνος:** NOC/SOC Operator (για τηλεφωνικά), Αυτόματο σύστημα (για Web/Email)

**Χρόνος:** < 10 δευτερόλεπτα

---

#### **ΒΗΜΑ 2: Επικύρωση Αιτούντος**

**Τι συμβαίνει:**
- Ο χειριστής (ή το αυτόματο σύστημα) **επικυρώνει την ταυτότητα** του αιτούντος σύμφωνα με τις διαδικασίες της Ενότητας 2:
  - Τηλέφωνο: Μέθοδος A, B, ή C (§2.1.2)
  - Web: 2FA login (§2.2)
  - Email: Ψηφιακή υπογραφή (§2.3)
  - In-person: Επίδειξη ταυτότητας (§2.4)

**Αποτέλεσμα:**
- ✅ **Επιτυχής επικύρωση:** Κατάσταση ticket → **"AUTHENTICATED"** → Συνέχεια στο Βήμα 3
- ❌ **Αποτυχία επικύρωσης:** Κατάσταση ticket → **"AUTHENTICATION_FAILED"**
  - Αποστολή ειδοποίησης στον αιτούντα (εάν διαθέσιμο email/phone)
  - Ticket κλείνει χωρίς εκτέλεση ανάκλησης
  - **Ειδοποίηση πραγματικού συνδρομητή** (αν υπάρχει υποψία απάτης)

**Υπεύθυνος:** RA Operator, NOC Operator, ή Αυτόματο σύστημα

**Χρόνος:** 2-10 λεπτά (τηλέφωνο), < 1 λεπτό (Web/Email), 5 λεπτά (in-person)

---

#### **ΒΗΜΑ 3: Εκτέλεση Ανάκλησης**

**🔐 ΚΡΙΣΙΜΗ ΛΕΙΤΟΥΡΓΙΑ - ΑΠΑΙΤΕΙ ΠΡΟΝΟΜΙΑ CA ADMINISTRATOR**

**Τι συμβαίνει:**

1. **Έγκριση από CA Administrator:**
   - Ο εξουσιοδοτημένος **CA Administrator** (ή αυτοματοποιημένο σύστημα με ασφαλείς πολιτικές) εγκρίνει την ανάκληση
   - **Dual control** για high-value certificates: 2 CA Administrators πρέπει να εγκρίνουν (4-eyes principle)

2. **Ενημέρωση CA Database:**
   - Το σύστημα ενημερώνει τη **βάση δεδομένων της CA** (Certificate Authority Database):
     ```sql
     UPDATE certificates
     SET status = 'revoked',
         revocation_reason = [REASON_CODE],
         revocation_timestamp = [UTC_TIMESTAMP],
         revoked_by_operator = [OPERATOR_ID]
     WHERE serial_number = [CERT_SERIAL]
     ```
   - **Atomic transaction:** Η ενημέρωση είναι atomic και logged (δεν μπορεί να διακοπεί στη μέση)

3. **Καταχώρηση Reason Code:**
   Σύμφωνα με **RFC 5280, §5.3.1**, οι κωδικοί λόγων ανάκλησης είναι:

   | Code | CRLReason | Περιγραφή (Ελληνικά) | Χρήση |
   |------|-----------|---------------------|-------|
   | 0 | unspecified | Μη καθορισμένος λόγος | Γενική ανάκληση χωρίς συγκεκριμένο λόγο |
   | 1 | keyCompromise | Διαρροή ιδιωτικού κλειδιού | **Κρίσιμο:** Το κλειδί έχει διαρρεύσει ή υποπτεύεται διαρροή |
   | 2 | cACompromise | Διαρροή κλειδιού CA | **Έκτακτο:** Χρησιμοποιείται μόνο για CA key compromise (§7.1) |
   | 3 | affiliationChanged | Αλλαγή σχέσης | Ο συνδρομητής άλλαξε εργοδότη, ρόλο, ή οργανισμό |
   | 4 | superseded | Αντικαταστάθηκε | Νέο πιστοποιητικό εκδόθηκε για τον ίδιο συνδρομητή |
   | 5 | cessationOfOperation | Παύση λειτουργίας | Ο συνδρομητής παύει να χρησιμοποιεί ψηφιακές υπογραφές |
   | 6 | certificateHold | Αναστολή (προσωρινή) | **Μόνο για CRL** - OCSP επιστρέφει "revoked" (§4) |
   | 8 | removeFromCRL | Αφαίρεση από CRL | Επαναφορά από αναστολή (§4.2) |
   | 9 | privilegeWithdrawn | Ανάκληση προνομίου | Το δικαίωμα χρήσης πιστοποιητικού αφαιρέθηκε |
   | 10 | aACompromise | Διαρροή Attribute Authority | Σπάνια χρήση |

4. **Timestamp (Χρονοσήμανση):**
   - Η ακριβής ώρα ανάκλησης καταγράφεται σε **UTC με ακρίβεια millisecond**
   - Format: `YYYY-MM-DDTHH:MM:SS.sssZ` (ISO 8601)
   - Παράδειγμα: `2025-01-15T14:23:47.382Z`
   - **Σημασία:** Αυτή η χρονοσήμανση καθορίζει από πότε το πιστοποιητικό θεωρείται άκυρο

5. **Audit Log:**
   - Η ενέργεια καταγράφεται σε **immutable audit log** (append-only, tamper-proof):
     ```
     [2025-01-15T14:23:47.382Z] REVOCATION_EXECUTED
     Ticket: REV-20250115-0042
     Certificate: 0x3F2A1B9C4D5E6F7A
     Reason: keyCompromise (1)
     CA Admin: [OPERATOR_NAME] (ID: CA-ADM-007)
     Authentication Method: Phone (Secret Questions)
     ```

**Υπεύθυνος:** CA Administrator

**Χρόνος:** < 30 δευτερόλεπτα

---

#### **ΒΗΜΑ 4: Ενημέρωση Υπηρεσιών Κατάστασης**

**Τι συμβαίνει:**

1. **OCSP Cache Flush:**
   - Το σύστημα στέλνει **invalidation signal** σε όλους τους OCSP responders (τουλάχιστον 4 instances)
   - Οι OCSP responders **εκκαθαρίζουν (flush) το cache** για το συγκεκριμένο πιστοποιητικό
   - Η επόμενη OCSP request για αυτό το πιστοποιητικό θα επιστρέψει κατάσταση **"revoked"** με:
     - `revocationTime`: [UTC_TIMESTAMP]
     - `revocationReason`: [REASON_CODE]

2. **CRL Scheduling:**
   - Η ανάκληση **προγραμματίζεται** για συμπερίληψη στην επόμενη έκδοση:
     - **Delta CRL:** Εκδίδεται κάθε 1 ώρα → Η ανάκληση θα εμφανιστεί στην επόμενη Delta CRL (max 1 ώρα αναμονή)
     - **Full CRL:** Εκδίδεται κάθε 12 ώρες → Η ανάκληση θα εμφανιστεί στην επόμενη Full CRL (max 12 ώρες)
   - **Επείγον:** Για λόγο `cACompromise` (CA key compromise), εκδίδεται **άμεση έκτακτη CRL** (§7.1)

3. **Replication:**
   - Η ενημέρωση αναπαραγάγεται (replicate) σε όλα τα γεωγραφικά κατανεμημένα data centers:
     - Primary DC (Athens): < 1 δευτερόλεπτο
     - DR DC (Thessaloniki): < 5 δευτερόλεπτα
   - **Consistency check:** Αυτόματος έλεγχος ότι όλα τα replicas έχουν την ίδια κατάσταση

**Υπεύθυνος:** Αυτόματο σύστημα (Background Job)

**Χρόνος:** 
- OCSP: < 1 λεπτό (target), < 15 λεπτά (SLA)
- CRL: 1 ώρα (Delta), 12 ώρες (Full)

---

#### **ΒΗΜΑ 5: Ειδοποίηση Συνδρομητή**

**Τι συμβαίνει:**

Το σύστημα στέλνει **αυτόματες ειδοποιήσεις** στον συνδρομητή:

1. **Email Confirmation:**
   ```
   Θέμα: ✅ Επιβεβαίωση Ανάκλησης Πιστοποιητικού [CERT_SERIAL]
   
   Αγαπητέ/ή [SUBSCRIBER_NAME],
   
   Το πιστοποιητικό σας με σειριακό αριθμό 0x[CERT_SERIAL] ανακλήθηκε επιτυχώς.
   
   Στοιχεία Ανάκλησης:
   - Ticket ID: REV-20250115-0042
   - Ημερομηνία/Ώρα: 2025-01-15 14:23:47 UTC
   - Λόγος: Διαρροή κλειδιού (keyCompromise)
   - Κανάλι: Τηλεφωνική γραμμή
   
   Τι σημαίνει αυτό:
   - Το πιστο
